# 24. 클로저

## 핵심 내용

<aside>
💡 클로저는 **함수와 그 함수가 선언된 렉시컬 환경과의 조합**

</aside>

- 외부 함수보다 중첩 함수가 더 오래 유지되는 경우 중첩 함수는 이미 생명 주기가 종료된 외부 함수의 변수를 참조할 수 있다. 이러한 중첩 함수를 `클로저`라고 한다.
- 외부 함수의 실행 컨텍스트는 실행 컨텍스트 스택에서 제거될지라도 외부 함수의 렉시컬 환경까지 소멸하는 것은 아니기 때문이다.
- Closure는 자유 변수(클로저에 의해 참조되는 상위 스코프의 변수)에 대해 닫혀있다(묶여 있다)는 의미
- 모던 자바스크립트 엔진은 최적화를 통해 클로저가 참조하고 있지 않는 식별자는 기억하지 않는다. 기억해야 할 식별자를 기억하는 것은 불필요한 메뮤리 낭비라고 볼 수 없다.
- 클로저는 함수를 일급객체로 취급하는 언어(하스켈, 리스프, 얼랭, 스칼라 등)에서 사용되는 특성

## 렉시컬 스코프

<aside>
💡 함수를 어디서 호출했는지가 아닌 **함수를 어디에 정의**했는지에 따라 상위 스코프를 정적으로 결정

</aside>

- 렉시컬 스코프는 상위 스코프에 대한 참조가 함수 정의가 평가되는 시점에 함수가 정의된 위치에 의해 결정됨을 의미
- 함수 객체의 내부슬롯 [[Environment]]에 자신의 정의된 환경에 의해 결정된 상위 스코프(현재 실행중인 실행 컨텍스트의 렉시컬 환경)의 참조를 저장
- 위 정보는 해당 함수가 호출되었을 때 생성될 함수 렉시컬 환경의 `외부 렉시컬 환경에 대한 참조`에 저장

→ 이러한 원리에 의해 클로저는 상위 스코프로 자신이 선언된 외부 함수의 렉시컬 환경을 기억할 수 있다.

## 클로저의 활용

<aside>
💡 클로저는 **상태를 안전하게 변경하고 유지하기 위해 사용된다.**

</aside>

## 질문

- 자바스크립트에서 클로저의 원리를 스코프 체인의 관점에서 설명해주세요.